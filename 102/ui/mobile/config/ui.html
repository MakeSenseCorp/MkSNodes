<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="">

        <title>USB Cameras</title>

		[CSS]

		<link rel="stylesheet" href="/static/lib/bootstrap/css/bootstrap.min.css" crossorigin="anonymous">
		<link rel="stylesheet" href="/static/lib/bootstrap/css/bootstrap-slider.css" crossorigin="anonymous">
		<link rel="stylesheet" href="/static/lib/fontawesome-5.11.2/css/all.min.css">
		<link rel="stylesheet" href="/static/lib/bootstrap4-editable/css/bootstrap-editable.css">
		<link rel="stylesheet" href="/static/lib/chartjs/2.9.3/Chart.min.css">
		<link rel="stylesheet" href="/static/lib/datetimepicker/bootstrap-datetimepicker.min.css">
     
        <style>
            body {
              font-size: .875rem;
            }
            .feather {
              width: 16px;
              height: 16px;
              vertical-align: text-bottom;
            }
            html {
              position: relative;
              min-height: 100%;
            }
            body {
              /* Margin bottom by footer height */
              margin-bottom: 60px;
            }
            .footer {
              position: absolute;
              bottom: 0;
              width: 100%;
              /* Set the fixed height of the footer here */
              height: 60px;
              line-height: 60px; /* Vertically center the text there */
              background-color: #f5f5f5;
            }
            body > .container {
              padding: 60px 15px 0;
            }
            .footer > .container {
              padding-right: 15px;
              padding-left: 15px;
            }
            code {
              font-size: 80%;
            }
        </style>

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
    </head>
	<body>
		<main role="main" class="container">
      <div class="row">
        <div class="col-lg-12">
          <div class="card">
              <div class="card-body">
                <form>
                  <div class="form-group">
                    <label for="exampleInputEmail1">Email address</label>
                    <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp">
                    <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
                  </div>
                  <div class="form-group">
                    <label for="exampleInputPassword1">Password</label>
                    <input type="password" class="form-control" id="exampleInputPassword1">
                  </div>
                  <div class="form-group form-check">
                    <input type="checkbox" class="form-check-input" id="exampleCheck1">
                    <label class="form-check-label" for="exampleCheck1">Check me out</label>
                  </div>
                  <button type="submit" class="btn btn-primary">Submit</button>
                </form>
              </div>
          </div>
        </div>
      </div>
    </main>

		<script src="/static/lib/nodes/js/jquery_3_3_1/jquery.min.js"></script>
		<script src="/static/lib/nodes/js/popper_1_14_7/popper.min.js" crossorigin="anonymous"></script>
		<script src="/static/lib/bootstrap/js/bootstrap.min.js" crossorigin="anonymous"></script>
		<script src="/static/lib/bootstrap/js/bootstrap-slider.js" crossorigin="anonymous"></script>
		<script src="/static/lib/nodes/js/feather_4_19/feather.min.js"></script>
		<script src="/static/lib/nodes/map/feather_4_19/feather.min.js.map"></script>
		<script src="/static/lib/bootstrap4-editable/js/bootstrap-editable.min.js"></script>
		<script src="/static/lib/chartjs/2.9.3/Chart.min.js"></script>
		<script src="/static/lib/datetimepicker/bootstrap-datetimepicker.min.js"></script>
		<script src="/static/lib/crypto-js/3.1.2/components/core.js"></script>
		<script src="/static/lib/crypto-js/3.1.2/components/md5.js"></script>

		[SCRIPTS]

        <script>
          var GatewayIP = "[GATEWAY_IP]";
          var NodeUUID  = "[NODE_UUID]";

          String.prototype.format = function (args) {
            var str = this;
            return str.replace(String.prototype.format.regex, function(item) {
              var intVal = parseInt(item.substring(1, item.length - 1));
              var replace;
              if (intVal >= 0) {
                replace = args[intVal];
              } else if (intVal === -1) {
                replace = "{";
              } else if (intVal === -2) {
                replace = "}";
              } else {
                replace = "";
              }
              return replace;
            });
          };
          String.prototype.format.regex = new RegExp("{-?[0-9]+}", "g");

          $(document).ready(function() {
            // data-toggle="tooltip" title="Tooltip on right"
            $('[data-toggle="tooltip"]').tooltip();
          });

          function Node() {
            var self = this;

            // Get makesense api instanse.
            this.API  		= MkSAPIBuilder.GetInstance();
            this.Player 	= new Player(this.API);
            this.PlayList 	= new PlayList(this.API);
            // Update gateway IP address
            this.API.SetGlobalGatewayIP(GatewayIP);
            // Default handler
            this.API.OnUnexpectedDataArrived = function (packet) {
              console.log(packet);
            }

            return this;
          }

          Node.prototype.Init = function() {
          }

          Node.prototype.OnChangeEvent = function(packet) {
            console.log("OnNodeChangeEvent", this, packet.data.payload.event);
          }

          Node.prototype.Connect = function() {
            var self = this;
            console.log("Connect Gateway");
            this.API.ConnectGateway(function() {
              console.log("Connection to Gateway was established.");
              self.API.Gateway.OnNodeChangeEvent = self.OnChangeEvent.bind(self);
              self.API.GetNodeSensorsInfo(NodeUUID, function(res) {
                UserGetNodeSensorInfoHandler(res);
              });
            });
          }
          
          // Self-genrated area
          var node = new Node();
          node.Init();
          node.Connect();
          var UserGetNodeSensorInfoHandler = function(res) {
            var payload = res.data.payload;
            // User Code #1 - Start
            // User Code #1 - End
            node.API.RegisterOnNodeChange(NodeUUID, function(res) {
              console.log("UI have registered NODE successfuly", res);
            });
          }
          // Self-generated area

          $('#id-semsor-modal').on('hide.bs.modal', function (e) {
            
          })
          feather.replace();
        </script>
    </body>
</html>
